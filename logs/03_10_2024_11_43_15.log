[ 2024-03-10 11:43:16,622 ] root - INFO - Entered the start_data_ingestion method of TrainPipeline class
[ 2024-03-10 11:43:16,622 ] root - INFO - Getting the data from mongodb
[ 2024-03-10 11:43:16,622 ] root - INFO - Entered initiate_data_ingestion method of Data_Ingestion class
[ 2024-03-10 11:43:16,622 ] root - INFO - Exporting data from mongodb
[ 2024-03-10 11:43:16,737 ] root - INFO - MongoDB connection succesfull
[ 2024-03-10 11:43:18,256 ] root - INFO - Shape of dataframe: (25480, 12)
[ 2024-03-10 11:43:18,256 ] root - INFO - Saving exported data into feature store file path: artifact/03_10_2024_11_43_16/data_ingestion/feature_store/usvisa.csv
[ 2024-03-10 11:43:18,316 ] root - INFO - Got the data from mongodb
[ 2024-03-10 11:43:18,316 ] root - INFO - Entered split_data_as_train_test method of Data_Ingestion class
[ 2024-03-10 11:43:18,321 ] root - INFO - Performed train test split on the dataframe
[ 2024-03-10 11:43:18,322 ] root - INFO - Exited split_data_as_train_test method of Data_Ingestion class
[ 2024-03-10 11:43:18,322 ] root - INFO - Exporting train and test file path.
[ 2024-03-10 11:43:18,379 ] root - INFO - Exported train and test file path.
[ 2024-03-10 11:43:18,380 ] root - INFO - Performed train test split on the dataset
[ 2024-03-10 11:43:18,380 ] root - INFO - Exited initiate_data_ingestion method of Data_Ingestion class
[ 2024-03-10 11:43:18,380 ] root - INFO - Data ingestion artifact: DataIngestionArtifact(trained_file_path='artifact/03_10_2024_11_43_16/data_ingestion/ingested/train.csv', test_file_path='artifact/03_10_2024_11_43_16/data_ingestion/ingested/test.csv')
[ 2024-03-10 11:43:18,384 ] root - INFO - Got the train_set and test_set from mongodb
[ 2024-03-10 11:43:18,384 ] root - INFO - Exited the start_data_ingestion method of TrainPipeline class
[ 2024-03-10 11:43:18,384 ] root - INFO - Entered the start_data_validation method of TrainPipeline class
[ 2024-03-10 11:43:18,386 ] root - INFO - Starting data validation
[ 2024-03-10 11:43:18,409 ] root - INFO - Is required column present: [True]
[ 2024-03-10 11:43:18,409 ] root - INFO - All required columns present in training dataframe: True
[ 2024-03-10 11:43:18,409 ] root - INFO - Is required column present: [True]
[ 2024-03-10 11:43:18,409 ] root - INFO - All required columns present in testing dataframe: True
[ 2024-03-10 11:43:37,609 ] root - INFO - 1/12 drift detected.
[ 2024-03-10 11:43:37,611 ] root - INFO - Data validation artifact: DataValidationArtifact(validation_status=True, message='Drift not detected', drift_report_file_path='artifact/03_10_2024_11_43_16/data_validation/drift_report/report.yaml')
[ 2024-03-10 11:43:37,612 ] root - INFO - Performed the data validation operation
[ 2024-03-10 11:43:37,612 ] root - INFO - Exited the start_data_validation method of TrainPipeline class
[ 2024-03-10 11:43:37,614 ] root - INFO - Starting data transformation
[ 2024-03-10 11:43:37,614 ] root - INFO - Entered get_data_transformer_object method of DataTransformation class
[ 2024-03-10 11:43:37,614 ] root - INFO - Got numerical cols from schema config
[ 2024-03-10 11:43:37,614 ] root - INFO - Initialized StandardScaler, OneHotEncoder, OrdinalEncoder
[ 2024-03-10 11:43:37,614 ] root - INFO - Initialize PowerTransformer
[ 2024-03-10 11:43:37,614 ] root - INFO - Created preprocessor object from ColumnTransformer
[ 2024-03-10 11:43:37,614 ] root - INFO - Exited get_data_transformer_object method of DataTransformation class
[ 2024-03-10 11:43:37,614 ] root - INFO - Got the preprocessor object
[ 2024-03-10 11:43:37,640 ] root - INFO - Got train features and test features of Training dataset
[ 2024-03-10 11:43:37,640 ] root - INFO - Added company_age column to the Training dataset
[ 2024-03-10 11:43:37,640 ] root - INFO - drop the columns in drop_cols of Training dataset
[ 2024-03-10 11:43:37,640 ] root - INFO - Entered drop_columns methon of utils
[ 2024-03-10 11:43:37,641 ] root - INFO - Exited the drop_columns method of utils
[ 2024-03-10 11:43:37,646 ] root - INFO - Added company_age column to the Test dataset
[ 2024-03-10 11:43:37,646 ] root - INFO - Entered drop_columns methon of utils
[ 2024-03-10 11:43:37,646 ] root - INFO - Exited the drop_columns method of utils
[ 2024-03-10 11:43:37,646 ] root - INFO - drop the columns in drop_cols of Test dataset
[ 2024-03-10 11:43:37,647 ] root - INFO - Got train features and test features of Testing dataset
[ 2024-03-10 11:43:37,647 ] root - INFO - Applying preprocessing object on training dataframe and testing dataframe
[ 2024-03-10 11:43:37,683 ] root - INFO - Used the preprocessor object to fit transform the train features
[ 2024-03-10 11:43:37,690 ] root - INFO - Used the preprocessor object to transform the test features
[ 2024-03-10 11:43:37,690 ] root - INFO - Applying SMOTEENN on Training dataset
[ 2024-03-10 11:43:38,472 ] root - INFO - Applied SMOTEENN on training dataset
[ 2024-03-10 11:43:38,472 ] root - INFO - Applying SMOTEENN on testing dataset
[ 2024-03-10 11:43:38,540 ] root - INFO - Applied SMOTEENN on testing dataset
[ 2024-03-10 11:43:38,540 ] root - INFO - Created train array and test array
[ 2024-03-10 11:43:38,541 ] root - INFO - Entered the save_object method of utils
[ 2024-03-10 11:43:38,544 ] root - INFO - Exited the save_object method of utils
[ 2024-03-10 11:43:38,548 ] root - INFO - Saved the preprocessor object
[ 2024-03-10 11:43:38,548 ] root - INFO - Exited initiate_data_transformation method of Data_Transformation class
[ 2024-03-10 11:43:38,550 ] root - INFO - Entered initiate_model_trainer method of ModelTrainer class
[ 2024-03-10 11:43:38,552 ] root - INFO - Using neuro_mf to get best model object and report
[ 2024-03-10 11:43:38,555 ] neuro_mf - INFO - Started Initializing model from config file
[ 2024-03-10 11:43:38,555 ] neuro_mf - INFO - {'algorithm': 'kd_tree', 'weights': 'uniform', 'n_neighbors': 3}
[ 2024-03-10 11:43:38,555 ] neuro_mf - INFO - {'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 3}
[ 2024-03-10 11:43:38,556 ] neuro_mf - INFO - Initialized model: [InitializedModelDetail(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), param_grid_search={'algorithm': ['auto', 'ball_tree', 'kd_tree', 'brute'], 'weights': ['uniform', 'distance'], 'n_neighbors': [3, 5, 9]}, model_name='sklearn.neighbors.KNeighborsClassifier'), InitializedModelDetail(model_serial_number='module_1', model=RandomForestClassifier(max_depth=10, n_estimators=3), param_grid_search={'max_depth': [10, 15, 20], 'max_features': ['sqrt', 'log2'], 'n_estimators': [3, 5, 9]}, model_name='sklearn.ensemble.RandomForestClassifier')]
[ 2024-03-10 11:43:38,556 ] neuro_mf - INFO - ('**************************************************', 'training KNeighborsClassifier', '**************************************************')
[ 2024-03-10 11:43:38,556 ] neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2024-03-10 11:43:48,973 ] neuro_mf - INFO - ('**************************************************', 'training RandomForestClassifier', '**************************************************')
[ 2024-03-10 11:43:48,973 ] neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2024-03-10 11:43:51,068 ] neuro_mf - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9568863599934326)
[ 2024-03-10 11:43:51,069 ] neuro_mf - INFO - Best model: GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9568863599934326)
[ 2024-03-10 11:43:51,117 ] root - INFO - Entered the load_object method of utils
[ 2024-03-10 11:43:51,118 ] root - INFO - Exited the load_object method of utils
[ 2024-03-10 11:43:51,118 ] root - INFO - Created usvisa model object with preprocessor and model
[ 2024-03-10 11:43:51,118 ] root - INFO - Created best model file path.
[ 2024-03-10 11:43:51,118 ] root - INFO - Entered the save_object method of utils
[ 2024-03-10 11:43:51,122 ] root - INFO - Exited the save_object method of utils
[ 2024-03-10 11:43:51,122 ] root - INFO - Model trainer artifact: ModelTrainerArtifact(trained_model_file_path='artifact/03_10_2024_11_43_16/model_trainer/trained_model/model.pkl', metric_artifact=ClassificationMetricArtifact(f1_score=0.8268279274326554, precision_score=0.8435221536735839, recall_score=0.8107816711590297))
